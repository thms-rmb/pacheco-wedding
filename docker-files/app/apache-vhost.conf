<VirtualHost *:80>
        DocumentRoot /var/www/html

        ProxyPassMatch ^/wp-content/uploads/(.*)\.php$ !

        <Directory /var/www/html>
                Options Indexes FollowSymLinks
                AllowOverride None
                Require all granted

                RewriteEngine On
                RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
                RewriteBase /
                RewriteRule ^index\.php$ - [L]
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule . /index.php [L]
        </Directory>

        <Directory /var/www/html/wp-content/uploads>
                <FilesMatch "\.php$">
                        Order allow,deny
                        Deny from all
                </FilesMatch>
        </Directory>
</VirtualHost>
